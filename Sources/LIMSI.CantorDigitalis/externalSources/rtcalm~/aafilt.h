/******************************************************************************
AAFILT
 
 Copyright LIMSI-CNRS. Contributors: Christophe d'Alessandro, Boris Doval, Lionel Feugère, Sylvain Le Beux, Olivier Perrotin (2014)
 
 The software can be downloaded at the following URL:
 http://cantordigitalis.limsi.fr/
 
 This software is governed by the CeCILL license under French law and abiding by the rules of distribution of free software. You can use, modify and/ or redistribute the software under the terms of the CeCILL license as circulated by CEA, CNRS and INRIA at the following URL:
 http://www.cecill.info
 
 See the full license in the "license.txt" file.
 *********************************************************************************/	



//Upsample by 8 
/*
// Method : Upsampling Interpolation, 40 taps, fc=0.1
#define FSIZE 39

const double b[FSIZE+1] = {0.0003625997127834103272991939093117252923548,0.001260376873735084835015385351653094403446,0.002716538329805764841878845672340503369924,0.004698194571026521361434280521507389494218,0.007162092972271222844626858972105765133165,0.01005477622705564649807641330880869645625,0.01331364536229497075314753828934044577181,0.01686619557388245246865032811456330819055,0.02063352264073204517247361877707589883357,0.02452920900911784857223452149810327682644,0.02846596446088455259482152825967204989865,0.03234977176289963174404817891627317294478,0.03608959070181357031703583970738691277802,0.03959320218375982081138175772139220498502,0.04277389516069669828102206565745291300118,0.0455493191230332758467902465326915262267,0.04783699750491933466722827006378793157637,0.04956096749079983571073526604777725879103,0.05065395084407506298695977875468088313937,0.05105837898882651521015318962781748268753,0.05065395084407506298695977875468088313937,0.04956096749079983571073526604777725879103,0.04783699750491933466722827006378793157637,0.0455493191230332758467902465326915262267,0.04277389516069669828102206565745291300118,0.03959320218375982081138175772139220498502,0.03608959070181357031703583970738691277802,0.03234977176289963174404817891627317294478,0.02846596446088455259482152825967204989865,0.02452920900911784857223452149810327682644,0.02063352264073204517247361877707589883357,0.01686619557388245246865032811456330819055,0.01331364536229497075314753828934044577181,0.01005477622705564649807641330880869645625,0.007162092972271222844626858972105765133165,0.004698194571026521361434280521507389494218,0.002716538329805764841878845672340503369924,0.001260376873735084835015385351653094403446,0.0003625997127834103272991939093117252923548,0};

*/

/*
// Method : Sinc Windowing, 40 taps, chebyshev, -50 dB, fc=0.01
#define FSIZE 39

const double b[FSIZE+1] = {0.003715618176299776819621056844766826543491,0.002633485770795761498480613838069075427484,0.005089084898711746310362435963270399952307,0.006237216291341699317407609726160444552079,0.008919949245098739848414126640818722080439,0.0110079668142040211498144941515420214273,0.01422258469089246642191870506621853564866,0.01703450945065483959628416243958781706169,0.02071529593824765827503320281266496749595,0.02399856579243079407470773389832174871117,0.02790764400263712891048228925683361012489,0.03131832162001224606484584001009352505207,0.03510475932856749192723100350121967494488,0.03823463704016747538583231857955979648978,0.04149762231046412452872829135230858810246,0.04393318953106447460887906686366477515548,0.04629554589710851292272408841199649032205,0.04768844305650560277953786680882330983877,0.04886892791487304488207144004263682290912,0.04899973647561038647690878633511601947248,0.04886892923183058096148201343567052390426,0.04768844564871119878768368494093010667711,0.04629554966759702461231995584967080503702,0.04393319436424332480317644922251929529011,0.04149762802882148160499298228387488052249,0.03823464348082356023539318812254350632429,0.0351047662616920386202679082998656667769,0.0313183288737909973353801262874185340479,0.02790765132662244643602100779844477074221,0.02399857304955939699131484132976765977219,0.02071530288157067897780727605550055159256,0.01703451602329216982290027715407632058486,0.01422259065090287696864201905100344447419,0.01100797224046000735708794593392667593434,0.008919953846507771427765121075026399921626,0.006237220410007186972844994699016751837917,0.005089087913229959486693942949386837426573,0.002633489109263540631916677980939311964903,0.00371561413512505643932937182682962884428,0.002153438610260894909426143684072485484648};
*/

/*
// Method : Spline Transition Band, 20 taps, spline order 5, fb=0.06, fc=0.1
#define FSIZE 19

const double b[FSIZE+1] = {0.02229748600932211083369693938038835767657,0.0301200652328167187143925787040643626824,0.03810936814278750861539890593121526762843,0.04594598245978656625432279270171420648694,0.05329878764817237712936304205868509598076,0.05984385182486509635602089929307112470269,0.06528358652216141588819908747609588317573,0.0693648036214065816240648132406931836158,0.07189436729368456346911386845022207126021,0.07275128966514354811323528338107280433178,0.07189437070754590985988130569239729084074,0.06936481028520677383220061074098339304328,0.06528359611843762011496039576741168275476,0.05984386390259935351032538619620027020574,0.05329880165088658056093962045451917219907,0.0459459977596681570788383908165997127071,0.03810938407835221669595071602998359594494,0.03012008114740927222641175831086002290249,0.0222975012877681226519666068952574278228,0.01493200464197942146926667561501744785346};
*/

// Method : Optimal FIR filter  : pour sur-éch.=32
// fs=32*44100; rp=1; rs=40; f=[12000 32100]; a=[1 0]; dev=[(10^(rp/20)-1)/(10^(rp/20)+1)  10^(-rs/20)]; [n,fo,ao,w]=firpmord(f,a,dev,fs); b=firpm(n,fo,ao,w); freqz(b,1,1024,fs);
/*
#define FSIZE 100
const double b[FSIZE+1] = {-9.4349866142453397e-03,-1.5207114904137852e-03,-1.6066170637375355e-03,-1.6690510999515745e-03,-1.7041544821738961e-03,-1.7088587740639060e-03,-1.6790547974085087e-03,-1.6115285177385271e-03,-1.5023792515960332e-03,-1.3466253637754691e-03,-1.1461788727722081e-03,-8.9164147716837543e-04,-5.8498370902718339e-04,-2.2307869999572673e-04,1.9610841789843161e-04,6.7494377919044861e-04,1.2118647029598540e-03,1.8082074267026019e-03,2.4623682215876011e-03,3.1773989013534612e-03,3.9482684556726181e-03,4.7776780080900855e-03,5.6615122346679557e-03,6.5964702865582339e-03,7.5767577225329102e-03,8.5996803414044136e-03,9.6553692837897942e-03,1.0745632972435869e-02,1.1861686100635935e-02,1.3012426906176603e-02,1.4167844354932776e-02,1.5316460474173349e-02,1.6490210182947041e-02,1.7640527875713820e-02,1.8784466195044584e-02,1.9903075835622959e-02,2.0994785198543142e-02,2.2048865121986866e-02,2.3058041417636128e-02,2.4017625779444912e-02,2.4921466428671570e-02,2.5754636331944473e-02,2.6525653141178784e-02,2.7216839609462650e-02,2.7827656858541345e-02,2.8349598479903256e-02,2.8784550641602260e-02,2.9125379660160350e-02,2.9372436806981005e-02,2.9520022206359960e-02,2.9571612038171130e-02,2.9520022206359960e-02,2.9372436806981005e-02,2.9125379660160350e-02,2.8784550641602260e-02,2.8349598479903256e-02,2.7827656858541345e-02,2.7216839609462650e-02,2.6525653141178784e-02,2.5754636331944473e-02,2.4921466428671570e-02,2.4017625779444912e-02,2.3058041417636128e-02,2.2048865121986866e-02,2.0994785198543142e-02,1.9903075835622959e-02,1.8784466195044584e-02,1.7640527875713820e-02,1.6490210182947041e-02,1.5316460474173349e-02,1.4167844354932776e-02,1.3012426906176603e-02,1.1861686100635935e-02,1.0745632972435869e-02,9.6553692837897942e-03,8.5996803414044136e-03,7.5767577225329102e-03,6.5964702865582339e-03,5.6615122346679557e-03,4.7776780080900855e-03,3.9482684556726181e-03,3.1773989013534612e-03,2.4623682215876011e-03,1.8082074267026019e-03,1.2118647029598540e-03,6.7494377919044861e-04,1.9610841789843161e-04,-2.2307869999572673e-04,-5.8498370902718339e-04,-8.9164147716837543e-04,-1.1461788727722081e-03,-1.3466253637754691e-03,-1.5023792515960332e-03,-1.6115285177385271e-03,-1.6790547974085087e-03,-1.7088587740639060e-03,-1.7041544821738961e-03,-1.6690510999515745e-03,-1.6066170637375355e-03,-1.5207114904137852e-03,-9.4349866142453397e-03};
*/

// Method : Optimal FIR filter 
// Nombre de points = 40
// Pour sur-éch.=8
// Il faut compléter dans le patch d'utilisation par un filtre Passe-Bas à 14kHz
// fs=8*44100;rp=0.5;rs=45;f=[14000 30100];a=[1 0]; dev=[(10^(rp/20)-1)/(10^(rp/20)+1)  10^(-rs/20)];[n,fo,ao,w]=firpmord(f,a,dev,fs);b=firpm(n,fo,ao,w);freqz(b,1,2048,fs);save '/tmp/filter' b -ASCII -DOUBLE -TABS
// Remarque : les oscillations effectives sont : 0.4 en BP et 41.2 en BA
#define FSIZE 39
const double b[FSIZE+1] = {4.7880735079536899e-03,5.2716521987904684e-04,-8.6672704415748395e-04,-3.3074138778760140e-03,-6.6430133690870627e-03,-1.0475304630573041e-02,-1.4174175150542558e-02,-1.6909517197574365e-02,-1.7762393110336824e-02,-1.5830936285743162e-02,-1.0403555829646914e-02,-1.0852484806258330e-03,1.2050523251679971e-02,2.8456912204143831e-02,4.7089882472306673e-02,6.6471715284802391e-02,8.4923201787369368e-02,1.0068363899363983e-01,1.1219040534256594e-01,1.1825971868091878e-01,1.1825971868091878e-01,1.1219040534256594e-01,1.0068363899363983e-01,8.4923201787369368e-02,6.6471715284802391e-02,4.7089882472306673e-02,2.8456912204143831e-02,1.2050523251679971e-02,-1.0852484806258330e-03,-1.0403555829646914e-02,-1.5830936285743162e-02,-1.7762393110336824e-02,-1.6909517197574365e-02,-1.4174175150542558e-02,-1.0475304630573041e-02,-6.6430133690870627e-03,-3.3074138778760140e-03,-8.6672704415748395e-04,5.2716521987904684e-04,4.7880735079536899e-03};
